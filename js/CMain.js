function CMain(e){var s,t,i,a,o=0,r=0,n=STATE_LOADING;this.initContainer=function(){var e=document.getElementById("canvas_game");(s_oStage=new createjs.Stage(e)).preventSelection=!1,createjs.Touch.enable(s_oStage,!0),s_oStageUpper3D=new createjs.Stage(document.getElementById("canvas_upper_3d")),!1===(s_bMobile=isMobile())&&s_oStage.enableMouseOver(20),s_iPrevTime=(new Date).getTime(),createjs.Ticker.framerate=FPS,createjs.Ticker.on("tick",this._update),navigator.userAgent.match(/Windows Phone/i)&&(DISABLE_SOUND_MOBILE=!0),s_oSpriteLibrary=new CSpriteLibrary,s_oLocalStorage=new CLocalStorage,i=new CPreloader},this.preloaderReady=function(){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||this._initSounds(),this._loadImages(),s=t=!0},this.soundLoaded=function(){o++;var e=Math.floor(o/r*100);i.refreshLoader(e)},this._initSounds=function(){Howler.mute(!s_bAudioActive),(s_aSoundsInfo=new Array).push({path:"./sounds/",filename:"click",loop:!1,volume:1,ingamename:"click"}),s_aSoundsInfo.push({path:"./sounds/",filename:"level_win",loop:!1,volume:1,ingamename:"level_win"}),s_aSoundsInfo.push({path:"./sounds/",filename:"game_over",loop:!1,volume:1,ingamename:"game_over"}),s_aSoundsInfo.push({path:"./sounds/",filename:"ball_collision",loop:!1,volume:1,ingamename:"ball_collision"}),s_aSoundsInfo.push({path:"./sounds/",filename:"ball_in_hole",loop:!1,volume:1,ingamename:"ball_in_hole"}),s_aSoundsInfo.push({path:"./sounds/",filename:"edge_collision",loop:!1,volume:1,ingamename:"edge_collision"}),s_aSoundsInfo.push({path:"./sounds/",filename:"stick_shot",loop:!1,volume:1,ingamename:"stick_shot"}),s_aSoundsInfo.push({path:"./sounds/",filename:"soundtrack",loop:!0,volume:1,ingamename:"soundtrack"}),r+=s_aSoundsInfo.length,s_aSounds=new Array;for(var e=0;e<s_aSoundsInfo.length;e++)this.tryToLoadSound(s_aSoundsInfo[e],!1)},this.tryToLoadSound=function(e,i){setTimeout(function(){s_aSounds[e.ingamename]=new Howl({src:[e.path+e.filename+".mp3"],autoplay:!1,preload:!0,loop:e.loop,volume:e.volume,onload:s_oMain.soundLoaded,onloaderror:function(e,i){for(var s=0;s<s_aSoundsInfo.length;s++)if(e===s_aSounds[s_aSoundsInfo[s].ingamename]._sounds[0]._id){s_oMain.tryToLoadSound(s_aSoundsInfo[s],!0);break}},onplayerror:function(e){for(var i=0;i<s_aSoundsInfo.length;i++)if(e===s_aSounds[s_aSoundsInfo[i].ingamename]._sounds[0]._id){s_aSounds[s_aSoundsInfo[i].ingamename].once("unlock",function(){s_aSounds[s_aSoundsInfo[i].ingamename].play(),"soundtrack"===s_aSoundsInfo[i].ingamename&&null!==s_oGame&&setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME)});break}}})},i?200:0)},this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this),s_oSpriteLibrary.addSprite("but_play","./sprites/but_play.webp"),s_oSpriteLibrary.addSprite("logo_menu","./sprites/logo_menu.webp"),s_oSpriteLibrary.addSprite("bg_game","./sprites/bg_game.webp"),s_oSpriteLibrary.addSprite("but_exit","./sprites/but_exit.webp"),s_oSpriteLibrary.addSprite("bg_menu","./sprites/bg_menu.webp"),s_oSpriteLibrary.addSprite("audio_icon","./sprites/audio_icon.webp"),s_oSpriteLibrary.addSprite("logo_ctl","./sprites/logo_ctl.webp"),s_oSpriteLibrary.addSprite("but_credits","./sprites/but_credits.webp"),s_oSpriteLibrary.addSprite("but_fullscreen","./sprites/but_fullscreen.webp"),s_oSpriteLibrary.addSprite("but_settings","./sprites/but_settings.webp"),s_oSpriteLibrary.addSprite("pool_table","./sprites/pool_table.webp"),s_oSpriteLibrary.addSprite("balls","./sprites/2d_balls.webp"),s_oSpriteLibrary.addSprite("stick","./sprites/stick.webp"),s_oSpriteLibrary.addSprite("player_gui","./sprites/player_gui.webp"),s_oSpriteLibrary.addSprite("highlight_player","./sprites/highlight_player.webp"),s_oSpriteLibrary.addSprite("msg_box","./sprites/msg_box.webp"),s_oSpriteLibrary.addSprite("ball_spin_gui","./sprites/ball_spin_gui.webp"),s_oSpriteLibrary.addSprite("ball_spin_token","./sprites/ball_spin_token.webp"),s_oSpriteLibrary.addSprite("but_home","./sprites/but_home.webp"),s_oSpriteLibrary.addSprite("but_restart","./sprites/but_restart.webp"),s_oSpriteLibrary.addSprite("but_lang","./sprites/but_lang.webp"),s_oSpriteLibrary.addSprite("but_next","./sprites/but_next.webp"),s_oSpriteLibrary.addSprite("but_continue","./sprites/but_continue.webp"),s_oSpriteLibrary.addSprite("but_yes","./sprites/but_yes.webp"),s_oSpriteLibrary.addSprite("but_no","./sprites/but_no.webp"),s_oSpriteLibrary.addSprite("vs_man_panel","./sprites/vs_man_panel.webp"),s_oSpriteLibrary.addSprite("vs_pc_panel","./sprites/vs_pc_panel.webp"),s_oSpriteLibrary.addSprite("but_text","./sprites/but_text.webp"),s_oSpriteLibrary.addSprite("ball_shadow","./sprites/ball_shadow.webp"),s_oSpriteLibrary.addSprite("but_arrow_left","./sprites/but_arrow_left.webp"),s_oSpriteLibrary.addSprite("but_arrow_right","./sprites/but_arrow_right.webp"),s_oSpriteLibrary.addSprite("hand_cue_ball","./sprites/hand_cue_ball.webp"),s_oSpriteLibrary.addSprite("shot_bar","./sprites/shot_bar.webp"),s_oSpriteLibrary.addSprite("over_shot_bar","./sprites/over_shot_bar.webp");for(var e=0;e<TABLE_UPPER_BUMPER.length;e++){var i=TABLE_UPPER_BUMPER[e].sprite;s_oSpriteLibrary.addSprite(i,"./sprites/"+i+".webp")}for(e=0;e<4;e++)s_oSpriteLibrary.addSprite("bg_interactive_help_"+e,"./sprites/bg_interactive_help_"+e+".webp");for(e=0;e<HAND_ANIM_NUM_FRAMES;e++)s_oSpriteLibrary.addSprite("hand_anim_"+e,"./sprites/hand_anim/hand_anim_"+e+".webp");r+=s_oSpriteLibrary.getNumSprites(),s_oTextureLibrary=[];var s=new THREE.LoadingManager;s.onLoad=this._onTexturesLoaded(),r+=TEXTURE_NAME.length;for(var t=new THREE.TextureLoader(s),e=0;e<TEXTURE_NAME.length;e++){var i=TEXTURE_NAME[e].name,a=TEXTURE_NAME[e].path;s_oTextureLibrary[i]=t.load(a,this._onImagesLoaded)}s_oSpriteLibrary.loadSprites()},this._onTexturesLoaded=function(){},this._onImagesLoaded=function(){o++;var e=Math.floor(o/r*100);i.refreshLoader(e)},this._onAllImagesLoaded=function(){},this._allResourcesLoaded=function(){i.unload();try{saveItem(LOCALSTORAGE_STRING+"ls_available","ok")}catch(e){s_bStorageAvailable=!1}s_oSoundTrack=playSound("soundtrack",1,!0),s_oMain.gotoMenu()},this.gotoMenu=function(){new CMenu,n=STATE_MENU},this.gotoDifficultyMenu=function(){new CDifficutlyMenu,n=STATE_MENU},this.gotoGame=function(){a=new CGame,n=STATE_GAME},this.levelSelected=function(e){(s_iLevelSelected=e)>=s_iLastLevel&&(s_iLastLevel=e)},this.stopUpdateNoBlockAndTick=function(){t=!1},this.startUpdateNoBlockAndTick=function(){t=!0},this.stopUpdateNoBlock=function(){s=!1,createjs.Ticker.paused=!0},this.startUpdateNoBlock=function(){s_iPrevTime=(new Date).getTime(),s=!0,createjs.Ticker.paused=!1},this.stopUpdate=function(){s=!1,createjs.Ticker.paused=!0,$("#block_game").css("display","block"),!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||Howler.mute(!0)},this.startUpdate=function(){s_iPrevTime=(new Date).getTime(),s=!0,createjs.Ticker.paused=!1,$("#block_game").css("display","none"),!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_bAudioActive&&Howler.mute(!1)},this._update=function(e){var i;!1!==s&&(i=(new Date).getTime(),s_iTimeElaps=i-s_iPrevTime,s_iCntFps++,s_iPrevTime=i,1e3<=(s_iCntTime+=s_iTimeElaps)&&(s_iCurFps=s_iCntFps,s_iCntTime-=1e3,s_iCntFps=0),n===STATE_GAME&&t&&a.update(),void 0!==s_oStage&&s_oStage.update(e),void 0!==s_oStageUpper3D&&s_oStageUpper3D.update(e))},s_oMain=this,s_bAudioActive=e.audio_enable_on_startup,ENABLE_FULLSCREEN=e.fullscreen,ENABLE_CHECK_ORIENTATION=e.check_orientation,POINTS_FOR_BALL_POT=e.points_for_ball_pot,POINTS_FOR_FAULT=e.points_for_fault;e=navigator.language.split("-")[0];s_iCurLang=LANG_CODES[e],console.log("LANG_CODES["+navigator.language+"] "+s_iCurLang),refreshLanguage(),this.initContainer()}var s_bMobile,s_oDrawLayer,s_oStage,s_oStageUpper3D,s_oSpriteLibrary,s_oTextureLibrary,s_oLocalStorage,s_aSoundsInfo,s_bAudioActive=!1,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_oSoundTrack=null,s_oMain=null,s_bFullscreen=!1,s_bStorageAvailable=!0,s_bInteractiveHelp=!0,s_iGameMode=GAME_MODE_EIGHT,s_iPlayerMode=GAME_MODE_CPU,s_iCurLang=LANG_EN,s_iGameDifficulty=EASY;