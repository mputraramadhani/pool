var ON_MOUSE_DOWN_POWER_BAR=0,ON_PRESS_MOVE_POWER_BAR=1,ON_PRESS_UP_POWER_BAR=2;function CShotPowerBar(e,t,i,s=s_oStage){var o,a,h,c,_,u,d,g,p,y,w,E,S,O,P;this._init=function(e,t,i,s){y=!0,h=e,(o=new createjs.Container).x=t,o.y=i,h.addChild(o),P=!1;var n=s_oSpriteLibrary.getSprite("over_shot_bar");a=new createjs.Container,o.addChild(a);var r=s_oSpriteLibrary.getSprite("shot_bar");(h=createBitmap(r)).y=15-n.height,a.addChild(h),a.y=p=15,g=n.height-60;e=s_oSpriteLibrary.getSprite("stick");(h=createBitmap(e)).x=r.width/2,h.regX=e.width,h.regY=e.height/2,h.rotation-=90,a.addChild(h);e=createBitmap(n);e.x=-15,e.y=-15,o.addChild(e);e=new createjs.Shape;e.graphics.beginFill("black").drawRoundRect(0,0,n.width-30,n.height-30,16),a.mask=e,u={x:0,y:0},c={x:t,y:i},_={x:-n.width,y:i},(d=new createjs.Shape).graphics.beginFill("black").drawRect(0,0,r.width,r.height),d.x=o.x,d.y=o.y,d.alpha=.01,s.addChild(d),w=new Array,E=new Array,S=new Array,O={}},this.initEventListener=function(){O.mousedown=d.on("mousedown",this._onPressMouseDown,this)},this._onPressMouseDown=function(e){y&&(createjs.Tween.removeTweens(a),u={x:e.stageX,y:e.stageY},this.triggerEvent(ON_MOUSE_DOWN_POWER_BAR),O.pressmove=d.on("pressmove",this._onPressMove,this),O.pressup=d.on("pressup",this._onPressUp,this))},this._onPressMove=function(e){y&&((e=e.stageY-u.y)<p?e=p:g<e&&(e=g),a.y=e,S[ON_PRESS_MOVE_POWER_BAR]=this._normalizePowerShot(e),this.triggerEvent(ON_PRESS_MOVE_POWER_BAR))},this._normalizePowerShot=function(e){return linearFunction(e,p,g,0,MAX_POWER_SHOT)},this._onPressUp=function(){y&&(this.triggerEvent(ON_PRESS_UP_POWER_BAR),d.off("pressmove",O.pressmove),d.off("pressup",O.pressup))},this._reset=function(e=300){createjs.Tween.get(a,{override:!0}).to({y:p},e,createjs.Ease.cubicIn)},this.show=function(e=500){this._reset(0),P=!0,createjs.Tween.get(o,{override:!0}).to({x:c.x,y:c.y},e,createjs.Ease.cubicOut).call(function(){this.setInput(!0)},null,this).on("change",function(){d.x=o.x,d.y=o.y})},this.hide=function(e=500){P&&(P=!1,this.setInput(!1),createjs.Tween.get(o,{override:!0}).to({x:_.x,y:_.y},e,createjs.Ease.cubicIn).on("change",function(){d.x=o.x,d.y=o.y}))},this.setInput=function(e){y=e},this.setStickY=function(e){a.y=e},this.triggerEvent=function(e){w[e]&&w[e].call(E[e],S[e])},this.addEventListener=function(e,t,i,s){w[e]=t,E[e]=i,S[e]=s},this._init(e,t,i,s)}