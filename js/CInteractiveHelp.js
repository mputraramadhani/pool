var INTERACTIVE_ALPHA_FADE=.01,ON_END_TUTORIAL=0,TUTORIAL_MOVE_STICK_BUTTONS=0,TUTORIAL_SHOT_DESKTOP=1,TUTORIAL_RESPOT_CUE=2,TUTORIAL_CUE_EFFECT=3,TUTORIAL_SHOT_MOBILE=4,TUTORIAL_MOVE_STICK_MOBILE=5;function CInteractiveHelp(e){var r,a,n,o,s,c,_,T,l,h,E,d,u,C,A,S;this._init=function(e){r=e,a=new createjs.Container,r.addChild(a),n=new createjs.Container,a.addChild(n),(c=new createjs.Shape).graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),c.alpha=INTERACTIVE_ALPHA_FADE,a.addChild(c),a.alpha=0,o=new createjs.Container,a.addChild(o);var t=s_oSpriteLibrary.getSprite("but_next");h={x:CANVAS_WIDTH-t.width/2-10,y:t.height/2+10};var i={x:0,y:0};new CGfxButton(i.x,i.y,t,o).addEventListener(ON_MOUSE_UP,this._onPressUpButSkip,this),s=new createjs.Container,a.addChild(s);e=s_oSpriteLibrary.getSprite("but_continue");E={x:CANVAS_WIDTH-t.width/2-10,y:CANVAS_HEIGHT-t.height/2-10};i={x:0,y:0};l=new CGfxButton(i.x,i.y,e,s);new CTLText(o,-t.width-220,-50,240,80,60,"right","#fff",FONT_GAME,1.1,0,0,TEXT_INTERACTIVE_HELP_SKIP_TUTORIAL,!0,!0,!1,!1),(d=new Array)[TUTORIAL_MOVE_STICK_BUTTONS]={toExecute:!0,cb:this._tutorialMoveStick},d[TUTORIAL_SHOT_DESKTOP]={toExecute:!0,cb:this._tutorialShotWithStickDesktop},d[TUTORIAL_RESPOT_CUE]={toExecute:!0,cb:this._tutorialRespotCue},d[TUTORIAL_CUE_EFFECT]={toExecute:!0,cb:this._tutorialCueEffect},d[TUTORIAL_SHOT_MOBILE]={toExecute:!0,cb:this._tutorialShotWithStickMobile},d[TUTORIAL_MOVE_STICK_MOBILE]={toExecute:!0,cb:this._tutorialMoveStickMobile},_=!1,u=new Array,C=new Array,A=new Array,S=new Array},this.startTutorial=function(t){var e,i,r=t.tutorial;d[r].toExecute&&(_?u.push({info:t.info,tutorial:r}):(e=INTERACTIVE_ALPHA_FADE,i=d[r].cb,n.alpha=1,a.alpha=0,createjs.Tween.get(a,{override:!0}).to({alpha:1},500,createjs.Ease.cubicOut).call(function(){var e=t.info.on_show_tutorial;void 0!==e&&e.cb.call(e.scope,e.param)}),createjs.Tween.get(c,{override:!0}).to({alpha:e},500,createjs.Ease.cubicIn),i={cb:i,scope:this,param:t.info},d[T=r].toExexute=!1,_=!0,t.info.movement?t.info.item.animMovement(t.info.pos,i,t.info.cb_movement):i.cb.call(i.scope,i.param)))},this._tutorialShotWithStickMobile=function(e){var t=e.param,i=s_oSpriteLibrary.getSprite("bg_interactive_help_3"),e=createBitmap(i);n.addChild(e),c.removeAllEventListeners();i=new createjs.Container;n.addChild(i),i.x=691,i.y=500;e=TEXT_INTERACTIVE_STICK_SHOT_MOBILE;new CTLText(i,0-350,0-75,700,150,40,"center","#fff",FONT_GAME,1.1,0,0,e,!0,!0,!0,!1);var r=this.createHand();r.gotoAndStop("idle"),r.x=240,r.y=370,r.rotation=135,n.addChild(r);createjs.Tween.get(r,{loop:!0}).call(function(){createjs.Tween.get(r).to({scaleX:.8,scaleY:.8},200),t._onPressMouseDown({stageX:240,stageY:370})}).wait(200+s_iTimeElaps).call(function(){createjs.Tween.get(r).to({y:870},1e3,createjs.Ease.cubicInOut).on("change",function(){t._onPressMove({stageY:r.y})})}).wait(1e3+s_iTimeElaps).call(function(){createjs.Tween.get(r).to({scaleX:1,scaleY:1},200),t._reset(300),t._onPressUp()}).wait(300+s_iTimeElaps).call(function(){createjs.Tween.get(r).to({y:370},500,createjs.Ease.cubicIn)}).wait(400+s_iTimeElaps);e=function(){r.removeAllEventListeners(),createjs.Tween.removeTweens(r),this._endRespotCueTutorial()};l.addEventListener(ON_MOUSE_UP,e,this),c.on("click",e,this,!1)},this._tutorialMoveStickMobile=function(){var e=new createjs.Shape;e.graphics.beginFill("rgba(0, 0, 0, 0.8").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),n.addChild(e),c.removeAllEventListeners();var t=new createjs.Container;n.addChild(t),t.x=CANVAS_WIDTH/2,t.y=270;e=TEXT_INTERACTIVE_HELP_MOVE_STICK_MOBILE_DRAG;new CTLText(t,0-500,0-75,1e3,150,40,"center","#fff",FONT_GAME,1.1,0,0,e,!0,!0,!0,!1);t=s_oSpriteLibrary.getSprite("ball_spin_gui"),e=createBitmap(t);e.x=CANVAS_WIDTH/2,e.y=CANVAS_HEIGHT/2,e.regX=t.width/2,e.regY=t.height/2,e.scaleX=e.scaleY=.29,n.addChild(e);t=new createjs.Container;t.x=e.x-e.regX*e.scaleX,t.y=e.y,n.addChild(t);var e=s_oSpriteLibrary.getSprite("stick"),i=createBitmap(e);i.x=BALL_RADIUS,i.regX=e.width+BALL_RADIUS,i.regY=e.height/2,t.addChild(i);var e=s_oSpriteLibrary.getSprite("hand_anim_0"),r=createBitmap(e);r.regX=e.width/2,r.regY=e.height/1.5,r.x=i.regX/2,r.y=100,r.rotation=135,t.addChild(r);t=function(){var e=linearFunction(r.y,-100,100,-20,20);i.y=.25*-e,i.rotation=e};t.call(this);var a=createjs.Tween.get(r,{loop:!0}).to({y:-100},1e3,createjs.Ease.cubicInOut).to({y:100},1e3,createjs.Ease.cubicInOut);a.on("change",t);t=function(){a.removeAllEventListeners(),this._endShotWithStickTutorial(a)};l.addEventListener(ON_MOUSE_UP,t,this),c.on("click",t,this,!1)},this._tutorialShotWithStickDesktop=function(){var e=new createjs.Shape;e.graphics.beginFill("rgba(0, 0, 0, 0.8").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT),n.addChild(e),c.removeAllEventListeners();var t=new createjs.Container;n.addChild(t),t.x=CANVAS_WIDTH/2,t.y=300;e=TEXT_INTERACTIVE_STICK_SHOT_DESKTOP;new CTLText(t,0-350,0-75,700,150,40,"center","#fff",FONT_GAME,1.1,0,0,e,!0,!0,!0,!1);var t=s_oSpriteLibrary.getSprite("ball_spin_gui"),i=createBitmap(t);i.x=CANVAS_WIDTH/2,i.y=CANVAS_HEIGHT/2,i.regX=t.width/2,i.regY=t.height/2,i.scaleX=i.scaleY=.29,n.addChild(i);var r=new createjs.Container;r.x=i.x-i.regX*i.scaleX,r.y=i.y,n.addChild(r);e=s_oSpriteLibrary.getSprite("stick"),t=createBitmap(e);t.regX=e.width,t.regY=e.height/2,r.addChild(t);var e=s_oSpriteLibrary.getSprite("hand_anim_0"),a=createBitmap(e);a.regX=e.width/2,a.regY=e.height/2,a.x=-t.regX/2,a.y=100,a.rotation=180,r.addChild(a);createjs.Tween.get(r,{loop:!0}).to({x:r.x-100},500,createjs.Ease.cubicIn).call(function(){createjs.Tween.get(a).to({alpha:0},300)}).wait(301).to({x:r.x+3},200,createjs.Ease.cubicIn).call(function(){createjs.Tween.get(i,{override:!0}).to({x:CANVAS_WIDTH,alpha:0},700)}).wait(701).call(function(){createjs.Tween.get(a,{override:!0}).to({alpha:1},400),i.x=CANVAS_WIDTH/2,i.y=CANVAS_HEIGHT/2,createjs.Tween.get(i,{override:!0}).to({alpha:1},400),createjs.Tween.get(r).to({x:i.x-i.regX*i.scaleX},400)}).wait(401);t=function(){this._endShotWithStickTutorial(r)};c.on("click",t,this,!1),l.addEventListener(ON_MOUSE_UP,t,this)},this._endShotWithStickTutorial=function(e){this.endTutorial(),createjs.Tween.removeTweens(e),c.removeAllEventListeners(),c.on("click",function(){})},this._tutorialCueEffect=function(e){var t=s_oSpriteLibrary.getSprite("bg_interactive_help_2"),i=createBitmap(t);n.addChild(i),c.removeAllEventListeners();t=function(){this._endRespotCueTutorial()};l.addEventListener(ON_MOUSE_UP,t,this),c.on("click",t,this,!1);i=new createjs.Container;n.addChild(i),i.x=480,i.y=600;t=s_bMobile?TEXT_INTERACTIVE_HELP_CUE_EFFECT_MOBILE:TEXT_INTERACTIVE_HELP_CUE_EFFECT_DESKTOP;new CTLText(i,0-300,0-75,600,150,40,"center","#fff",FONT_GAME,1.1,0,0,t,!0,!0,!0,!1);t=this.createHand();t.x=i.x,t.y=760,n.addChild(t)},this._endCueEffectTutorial=function(){this.endTutorial(),c.removeAllEventListeners(),c.on("click",function(){})},this._tutorialRespotCue=function(e){var t=s_oSpriteLibrary.getSprite("bg_interactive_help_1"),i=createBitmap(t);n.addChild(i),c.removeAllEventListeners();t=function(){this._endRespotCueTutorial()};l.addEventListener(ON_MOUSE_UP,t,this),c.on("click",t,this,!1);i=new createjs.Container;n.addChild(i),i.x=691,i.y=200;t=s_bMobile?TEXT_INTERACTIVE_HELP_RESPOT_CUE_MOBILE:TEXT_INTERACTIVE_HELP_RESPOT_CUE_DESKTOP;new CTLText(i,0-350,0-75,700,150,40,"center","#fff",FONT_GAME,1.1,0,0,t,!0,!0,!0,!1);t=this.createHand();t.x=i.x,t.y=380,n.addChild(t)},this._endRespotCueTutorial=function(){this.endTutorial(),c.removeAllEventListeners(),c.on("click",function(){})},this._tutorialMoveStick=function(e){var t=s_oSpriteLibrary.getSprite("bg_interactive_help_0"),i=createBitmap(t);n.addChild(i),c.removeAllEventListeners(),oCbCompleted=function(){this._endMoveStickTutorial()},l.addEventListener(ON_MOUSE_UP,oCbCompleted,this),c.on("click",oCbCompleted,this,!1);t=new createjs.Container;n.addChild(t),t.x=1380,t.y=550;i=s_bMobile?TEXT_INTERACTIVE_HELP_MOVE_STICK_MOBILE:TEXT_INTERACTIVE_HELP_MOVE_STICK_DESKTOP;new CTLText(t,0-350,0-100,700,200,40,"center","#fff",FONT_GAME,1.1,0,0,i,!0,!0,!0,!1);i=this.createHand();i.x=t.x,i.y=750,n.addChild(i)},this._endMoveStickTutorial=function(){this.endTutorial(),c.removeAllEventListeners(),c.on("click",function(){})},this.removeTweens=function(){createjs.Tween.removeTweens(a)},this.toExecuteTutorial=function(e){return d[e].toExecute},this.exeTutorial=function(){return _},this.endTutorial=function(){var t=this,e=createjs.Tween.get(a);u.length<1?(_=!1,e.to({alpha:0},500,createjs.Ease.cubicIn),e.call(function(){c.removeAllEventListeners(),a.removeChild(n),t.triggerEvent(ON_END_TUTORIAL)}),S[ON_END_TUTORIAL]=T):((e=createjs.Tween.get(a)).to({alpha:0},500,createjs.Ease.cubicIn),e.call(function(){var e=u.shift();if(void 0===e)return t.triggerEvent(ON_END_TUTORIAL),void(S[ON_END_TUTORIAL]=T);_=!1,n.removeAllChildren(),t.startTutorial(e)}))},this.createHand=function(){for(var e=new Array,t=0;t<HAND_ANIM_NUM_FRAMES;t++)e.push(s_oSpriteLibrary.getSprite("hand_anim_"+t));var i=s_oSpriteLibrary.getSprite("hand_anim_0"),r={images:e,frames:{width:i.width,height:i.height,regX:i.width/2,regY:i.height/2},animations:{loop:[0,19,"loop"]},framerate:30},r=new createjs.SpriteSheet(r);return createSprite(r,"loop",i.width/2,i.height/2,i.width,i.height)},this.triggerEvent=function(e){C[e]&&C[e].call(A[e],S[e])},this.addEventListener=function(e,t,i,r){C[e]=t,A[e]=i,S[e]=r},this._onPressUpButSkip=function(){c.dispatchEvent("click"),c.on("click",function(){}),u=new Array,this.endTutorial()},this.unload=function(){c.removeAllEventListeners(),r.removeChild(a)},this.refreshButtonsPos=function(){s.x=o.x=h.x-s_iOffsetX,o.y=h.y+s_iOffsetY,s.y=E.y-s_iOffsetY},this._init(e)}