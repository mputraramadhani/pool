function CBall(t,e,n){var i,r,s,a,o,c,l,u,h,_,f,E,g,d,A,L,C,I,b,T,O=t,D=e;this._init=function(t){l=i=!1,_=0,BALL_RADIUS,g=null,f=0,A=new createjs.Container,D.addChild(A);var e=s_oSpriteLibrary.getSprite("ball_shadow");(u=createBitmap(e)).regX=e.width/2,u.regY=e.height/2,A.addChild(u),DEBUG_SHOW_2D_SPRITE&&(e={images:[s_oSpriteLibrary.getSprite("balls")],frames:{width:BALL_DIAMETER,height:BALL_DIAMETER,regX:BALL_DIAMETER/2,regY:BALL_DIAMETER/2},animations:{ball_0:0,ball_1:1,ball_2:2,ball_3:3,ball_4:4,ball_5:5,ball_6:6,ball_7:7,ball_8:8,ball_9:9,ball_10:10,ball_11:11,ball_12:12,ball_13:13,ball_14:14,ball_15:15}},e=new createjs.SpriteSheet(e),d=createSprite(e,"ball_"+O,BALL_DIAMETER/2,BALL_DIAMETER/2,BALL_DIAMETER,BALL_DIAMETER),A.addChild(d)),L=s_oScenario.create3DBall(t,BALL_3D_DIAMETER/2,new THREE.Vector3(0,0,BALL_Z_POSITION)),s=new CVector2(0,0),a=new CVector2(0,0),o=new CVector2(0,0),r=new CVector2(0,0),c=new CVector2(0,0)},this.enableEvents=function(){C=new Array,I=new Array,b=new Array,T=new Array,(h=new createjs.Shape).graphics.beginFill("#aaa").drawRect(.5*-CUE_BALL_HIT_AREA_DIMENSION,.5*-CUE_BALL_HIT_AREA_DIMENSION,CUE_BALL_HIT_AREA_DIMENSION,CUE_BALL_HIT_AREA_DIMENSION),h.alpha=.009,A.addChild(h)},this.getObject3D=function(){return L},this.render=function(t){A.x=r.getX(),A.y=r.getY()},this.setVisible=function(t){A.visible=t},this.setDragging=function(t){l=t,L.position.z=t?BALL_Z_POSITION+20:BALL_Z_POSITION},this.setMask=function(t,e){(E=new createjs.Shape).graphics.beginFill("rgba(0,0,0,0.01)").drawCircle(t,e,POOL_HOLE_RADIUS),D.addChild(E),A.mask=E},this.removeMask=function(){E&&(A.mask=null)},this.setPos=function(t,e){A.x=t,A.y=e,r.set(t,e)},this.setY=function(t){A.y=t,r.set(A.x,A.y)},this.setX=function(t){A.x=t,r.set(A.x,A.y)},this.setPrevPos=function(t){o.setV(t)},this.setPosV=function(t){r.setV(t)},this.setScale=function(t){A.scale=t},this.addPos=function(t){r.add(t)},this.addForce=function(t){s.add(t)},this.addCurForce=function(t){a.add(t)},this.setCurForce=function(t,e){a.set(t,e)},this.setCurForceV=function(t){a.setV(t)},this.setTmpForce=function(t,e){s.set(t,e)},this.normalizeCurForce=function(){a.normalize()},this.scalarProductTmpForce=function(t){s.scalarProduct(t)},this.scalarProductCurForce=function(t){a.scalarProduct(t)},this.setFlagOnTable=function(t){i=t},this.inHole=function(t){g=t},this.getHole=function(){return g},this.getTmpForce=function(){return s},this.getCurForce=function(){return a},this.getCurForceLen=function(){return a.length()},this.getCurForceLenght2=function(){return a.length2()},this.getX=function(){return r.getX()},this.getY=function(){return r.getY()},this.getPos=function(){return r},this.getPrevPos=function(){return o},this.getNumber=function(){return O},this.isBallOnTable=function(){return i},this.isDragging=function(){return l},this.getEffectForceVector=function(){return c},this.setEffectForceX=function(t){c.set(t,c.getY())},this.setEffectForceY=function(t){c.set(c.getX(),t)},this.reset3DObjectTransformation=function(){this.setOpacityMaterial3D(1),L.scale.x=L.scale.y=L.scale.z=1;var t=new THREE.Color(1,1,1);L.material.color=t},this.setOpacityMaterial3D=function(t){var e=L.material;e.transparent=!0,.99<t&&(e.transparent=!(t=1)),e.opacity=t},this.fadeAnimInHole=function(t){var e=L.material;e.transparent=!0,u.visible=!1,createjs.Tween.get(e,{override:!0}).to({opacity:0},t,createjs.Ease.sineOut);var n=L.scale;createjs.Tween.get(n).to({x:.1,y:.1,z:.1},t,createjs.Ease.sineOut).call(function(){this.setCurForce(0,0),this.setPos(POS_RAIL_EXIT.x,POS_RAIL_EXIT.y)},null,this);e=e.color;createjs.Tween.get(e).to({r:0,g:0,b:0},.5*t,createjs.Ease.sineOut)},this.getSideEffect=function(){return f},this.setSideEffect=function(t){f=t},this.resetEdgeCollisionCount=function(){_=0},this.increaseEdgeCollisionCount=function(){_++},this.getEdgeCollisionCount=function(){return _},this._updateShadow=function(){var t;u.visible&&((t=new CVector2(TABLE_CENTER_COORDINATE.getX(),TABLE_CENTER_COORDINATE.getY())).subtract(r),u.x=-.03*t.getX(),u.y=-.03*t.getY(),t=linearFunction(t.length(),770,0,0,1),u.alpha=t)},this.triggerEvent=function(t,e){C&&C[e]&&C[e].call(I[e],t,b[e])},this.addEventListener=function(t,e,n,i){C&&(C[t]=e,I[t]=n,b[t]=i,T[t]=h.on(t,this.triggerEvent,this,!1,t))},this.removeEventListener=function(t){C[t]=null,I[t]=null,b[t]=null,h.off(t,T[t]),T[t]=null},this._init(n)}